---
title: "EDA: Diabetes Health Indicators"
format: html
editor: visual
---

# Introduction

The data used in this project comes from the CDC's 2015 Behavioral Risk Factor Surveillance System. The survey was conducted to collect uniform data on preventative health practices and risk behaviors that are linked to chronic diseases in adults. The diabetes health indicators dataset is a consolidated version of the entire 2015 survey, containing over 250,000 responses and variables related to diabetes, health status, and lifestyle.

The primary variable of interest for this project is Diabetes_012, which classifies respondents into three groups: 0 = no diabetes, 1 = prediabetes, 2 = diagnosed diabetes. Because this survey includes many health indicators that may relate to diabetes risk, this dataset is well-suited for exploring how variables can help predict diabetes status.

In this exploratory data analysis, I focus on variables that are known to be related to diabetes, such as BMI, age, general health rating, high blood pressure, high cholesterol, and physical activity. The goal of the EDA is to understand the structure of the data, check for missingness, summarize the distribution of the variables, and visualize how they relate to diabetes status. These insights will help guide my modeling decisions in the next part of this project.

# Data Import and Cleaning

First, I import my dataset. Most of the variables in this dataset are stored as numeric codes even though they represent categories (for example, 0/1 indicators or ordered groups). Before doing any summaries or plotting, I convert these coded variables into factors with meaningful labels so the results are easier to interpret. I also check for missingness in the data, and find no missing values. 

```{r}
library(tidyverse)

# Read in data
diabetes_df <- read_csv("diabetes_012_health_indicators_BRFSS2015.csv", show_col_types = FALSE)

# Convert categorical variables into factors
diabetes_df <- diabetes_df |>
  mutate(
    Diabetes_012 = factor(Diabetes_012, levels = c(0,1,2), labels = c("No Diabetes", "Prediabetes", "Diabetes")),
    HighBP = factor(HighBP, labels = c("No High BP", "High BP")),
    HighChol = factor(HighChol, labels = c("No High Chol", "High Chol")),
    CholCheck = factor(CholCheck, labels = c("No Check", "Checked")),
    Smoker = factor(Smoker, labels = c("Non-Smoker", "Smoker")),
    Stroke = factor(Stroke, labels = c("No Stroke", "Stroke")),
    HeartDiseaseorAttack = factor(HeartDiseaseorAttack, labels = c("No HD/Attack", "HD/Attack")),
    PhysActivity = factor(PhysActivity, levels = c(0, 1), labels = c("No Activity", "Activity")),
    Fruits = factor(Fruits, levels = c(0, 1), labels = c("No", "Yes")),
    Veggies = factor(Veggies, levels = c(0, 1), labels = c("No", "Yes")),
    HvyAlcoholConsump = factor(HvyAlcoholConsump, levels = c(0, 1), labels = c("No", "Yes")),
    AnyHealthcare = factor(AnyHealthcare, levels = c(0, 1), labels = c("No", "Yes")),
    NoDocbcCost = factor(NoDocbcCost, levels = c(0, 1), labels = c("No", "Yes")),
    GenHlth = factor(GenHlth, labels = c("Excellent","Very good","Good","Fair","Poor")),
    DiffWalk = factor(DiffWalk, levels = c(0, 1), labels = c("No Difficulty", "Difficulty Walking")),
    Sex = factor(Sex, labels = c("Female", "Male")),
    Age = factor(Age, levels = 1:13, labels = c("18–24", "25–29", "30–34", "35–39", "40–44", "45–49", "50–54", "55–59", "60–64", "65–69", "70–74", "75–79", "80+")),
    Education = factor(Education, levels = 1:6, labels = c("Kindergarten or less", "Grades 1–8", "Grades 9–11", "High school or GED", "Some college/technical school", "College graduate")),
    Income = factor(Income, levels = 1:8, labels = c("<$10,000", "$10,000–<$15,000", "$15,000–<$20,000", "$20,000–<$25,000", "$25,000–<$35,000", "$35,000–<$50,000", "$50,000–<$75,000", "$75,000+"))
    )
head(diabetes_df)

# Check for NA. No missing values were found.
colSums(is.na(diabetes_df))
```

# Summaries and Plots

Below I explore the distribution of several variables in the dataset and how they relate to diabetes status. The goal here is to get a sense of the structure of the data, look for patterns, check for imbalance, and see which predictors seem most strongly associated with diabetes.

```{r}
# Distribution of Diabetes Status
diabetes_df |>
  count(Diabetes_012) |>
  ggplot(aes(x = Diabetes_012, y = n, fill = Diabetes_012)) +
  geom_col() +
  labs(title = "Distribution of Diabetes Status", x = "Diabetes Category", y = "Count") +
  scale_fill_discrete(name = "Diabetes Status") +
  theme_minimal()
```

The first thing I check is the distribution of the response variable. Most people in the dataset do not have diabetes, with a small portion having diagnosed diabetes, and an even smaller group with prediabetes. This large imbalance is important because it could potentially affect model performance because models could learn to predict "no diabetes" every time.

```{r}
# Distribution of Physically Unhealthy Days
ggplot(diabetes_df, aes(x = PhysHlth)) +
  geom_histogram(bins = 30, fill = "#7fb3d5") +
  labs(title = "Distribution of Physically Unhealthy Days", x = "Number of Physically Unhealthy Days", y = "Count")
```

Physically unhealthy days has a big spike at zero, meaning a lot of people reported no physical health issues in the past month. However, there's also a long tail of people who reported many unhealthy days. This variable may help separate people with chronic conditions (including diabetes) from those without.

```{r}
# Diabetes Rate by Physical Health
diabetes_physhlth <- subset(diabetes_df, PhysHlth %in% c(0, 30))

diabetes_physhlth |>
  count(PhysHlth, Diabetes_012) |>
  group_by(PhysHlth) |>
  mutate(prop = n / sum(n)) |>
  ggplot(aes(x = PhysHlth, y = prop, fill = Diabetes_012)) +
    geom_col(position = "fill") +
    labs(title = "Diabetes Status by Physical Health", x = "Number of Days Physical Health was Not Good", y = "Proportion") +
    scale_x_continuous(breaks = c(0, 30)) +
    scale_fill_discrete(name = "Diabetes Status") +
    theme_minimal()

# Diabetes Rate by Mental Health
diabetes_menthlth <- subset(diabetes_df, MentHlth %in% c(0, 30))

diabetes_menthlth |>
  count(MentHlth, Diabetes_012) |>
  group_by(MentHlth) |>
  mutate(prop = n / sum(n)) |>
  ggplot(aes(x = MentHlth, y = prop, fill = Diabetes_012)) +
    geom_col(position = "fill") +
    labs(title = "Diabetes Status by Mental Health", x = "Number of Days Mental Health was Not Good", y = "Proportion") +
    scale_x_continuous(breaks = c(0, 30)) +
    scale_fill_discrete(name = "Diabetes Status") +
    theme_minimal()
```

Here I analyze the relationships between physical and mental health with diabetes. Respondents with 30 days of poor physical health were more likely to have diagnosed diabetes than those with 0 days of poor physical health. The same relationship was noted for mental health, though the difference was less pronounced. 

```{r}
# Distribution of BMI by Diabetes Status
ggplot(diabetes_df, aes(x = BMI, fill = Diabetes_012)) +
  geom_density(alpha = 0.4) +
  labs(title = "Distribution of Diabetes Status by BMI",
       x = "BMI", y = "Density") +
  scale_fill_discrete(name = "Diabetes Status") +
  theme_minimal()
```

This graph shows that BMI is skewed to the right for all diabetes statuses, but the mean BMI for prediabetic and diabetic respondents is higher than that for non-diabetic respondents. This could indicate a correlation between higher BMI and presence of diabetes. 

```{r}
# Diabetes Rate by Blood Pressure Status
diabetes_df |>
  count(Diabetes_012, HighBP) |>
  group_by(Diabetes_012) |>
  mutate(prop = n / sum(n)) |>
  ggplot(aes(x = Diabetes_012, y = prop, fill = HighBP)) +
    geom_col(position = "fill") +
    labs(title = "Blood Pressure Status by Diabetes Status", x = "Diabetes Status", y = "Proportion") +
    scale_fill_discrete(name = "Blood Pressure Status") +
    theme_minimal()
```

This plot compares blood pressure status across all three groups of diabetes status (people with diabetes vs prediabetes vs no diabetes). People with high blood pressure have a noticeably higher proportion of diabetes and prediabetes compared to people without high blood pressure. This lines up with expectations because high blood pressure and diabetes often occur together. This variable will probably be useful in the model.

```{r}
# Diabetes Status Across Age Groups
diabetes_df |>
  count(Age, Diabetes_012) |>
  ggplot(aes(x = Age, y = n, fill = Diabetes_012)) +
  geom_col(position = "fill") +
  labs(title = "Diabetes Status Across Age Groups", x = "Age Ranges", y = "Proportion") +
  scale_fill_discrete(name = "Diabetes Status") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

The proportion of diabetes goes up pretty consistently with age. Younger age groups barely show any diabetes cases, while the oldest groups have much higher rates. Because this pattern is so strong, age is likely to be one of the most important predictors.

```{r}
# Diabetes by General Health Rating
diabetes_df |>
  count(GenHlth, Diabetes_012) |>
  ggplot(aes(x = GenHlth, y = n, fill = Diabetes_012)) +
  geom_col(position = "fill") +
  labs(title = "Diabetes Status by General Health Status", x = "General Health Status", y = "Proportion") +
  scale_fill_discrete(name = "Diabetes Status") +
  theme_minimal()
```

This plot demonstrates that people who rate their general health as “fair” or “poor” have much higher rates of diabetes compared to those who say their health is “excellent” or “very good.” This makes sense and tells me general health might capture a lot of underlying conditions tied to diabetes.

# Modeling Link
[Click here for the Modeling Page](Modeling.html)
